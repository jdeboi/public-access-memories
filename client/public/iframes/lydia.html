<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="digital / net art gallery" />
    <link rel="author" href="http://jdeboi.com/">

    <!-- open graph -->
    <meta property="og:description" content="digital art gallery">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en_US">
    <meta property="og:title" content="public access memories">
    <meta property="og:site_name" content="public access memories">
    <meta property="og:url" content="https://publicaccessmemories.com">
    <meta property="og:image" content="http://www.publicaccessmemories.com/og.png">
    <meta property="og:image:secure_url" content="https://www.publicaccessmemories.com/og.png">
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="697">

    <title>public access memories</title>
</head>

<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script>
        let pMapper;
        let quadMap;

        let video;
        let isPlaying = false;

        let myFont;


        function preload() {
            video = createVideo(['https://jdeboi-public.s3.us-east-2.amazonaws.com/public_access_memories/home_body/lydia/homebody.mp4']);
            video.hide();
        }

        function setup() {
            createCanvas(windowWidth, windowHeight, WEBGL);

            textFont(myFont);

            pMapper = createProjectionMapper(this);
            quadMap = pMapper.createQuadMap(video.width, video.height);
        }

        function draw() {
            background(0);

            displayFrameRate();

            quadMap.clear();
            quadMap.translate(-quadMap.width / 2, -quadMap.height / 2);
            if (isPlaying)
                quadMap.image(video, 0, 0);
            quadMap.noFill();
            quadMap.stroke(0, 255, 0);
            quadMap.rect(5, 5, quadMap.width - 25, quadMap.height - 20);
        }

        function keyPressed() {
            switch (key) {
                case 'c':
                    pMapper.toggleCalibration();
                    break;
                case 'f':
                    let fs = fullscreen();
                    document.getElementById("header").style.display = "none";
                    fullscreen(!fs);
                    break;
                case 'l':
                    pMapper.load("maps/map.json");
                    break;

                case 's':
                    pMapper.save("map.json");
                    break;
            }
        }

        function mousePressed() {
            isPlaying = true;
            video.loop();
            pMapper.onClick();
        }

        function mouseDragged() {
            pMapper.onDrag();
        }

        function mouseReleased() {
            pMapper.onRelease();
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }

        function displayFrameRate() {
            fill(255);
            noStroke();
            text(round(frameRate()), -width / 2 + 20, -height / 2 + 20);
        }
    </script>
    <script src="/libs/p5.mapper.min.js"></script>
</body>

</html>